#include "myDev.h"

#include <Servo.h>

#define inCharConverter (inChar - 32)

Servo shouldeServo, elbowServo, wristServo, elbowRoll, handServo;

myDev myDev;

const uint8_t stepEna[3] = {8, 9, 10};
const uint8_t stepDir[3] = {11, 12, 13};
const uint8_t stepNo[3] = {14, 15, 16};

const uint8_t opticalSw[4] = {40, 41, 42, 43};

const uint8_t endSw[4] = {33, 34, 35, 36};

uint8_t inAscii;

int test = 3;

char inChar;

void setup() {
  Serial.begin(115200);
  myDev.registerPinEna(stepEna[0], stepEna[1], stepEna[2]);
  myDev.registerPinDir(stepDir[0], stepDir[1], stepDir[2]);
  myDev.registerPinStep(stepNo[0], stepNo[1], stepNo[2]);
  myDev.registerEndSw(endSw[0], endSw[1], endSw[2], endSw[3]);

  shouldeServo.attach(34);
  elbowServo.attach(35);
  wristServo.attach(36);
  elbowRoll.attach(37);
  handServo.attach(38);
}

void loop() {
  //myDev.homeAll();
  if (Serial.available()) {
    inChar = Serial.read();
    inAscii = inCharConverter;
    if (inAscii >= 0 && inAscii <= 94) {
      if (inAscii >= 1 && inAscii <= 2) {
        myDev.asciiGet(inCharConverter);
      }
    }
  }
}

void servoWorker() {
  shouldeServo.writeMicroseconds(700);
  elbowServo.writeMicroseconds(700);
  wristServo.writeMicroseconds(700);
  elbowRoll.writeMicroseconds(700);
  handServo.writeMicroseconds(700);  
}

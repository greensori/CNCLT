#include "cnclt.h"

#include <Servo.h>

/*
 * every joints are workiing with digital switch
 * when before start working, checking all digital switchs to initialize
 * stepping position. 
 * must install 3 switch. horizontal moving, tilting moving, rotation moving
 */

/*
 * stepping must setting same direction to initialize
 */

 /*
  * Serial on -> setting same direction stepper
  * while all switch value is high working with same spped
  */
enum {
  sumstep = 3 //horizont, tilt, rotation
};

struct endSwitch {
};

struct pts {
  int stepCount; //how many steps are working
  unsigned int pinStatus; // ( 0 == is idle status)
};

struct endSwitch endSwitch;
struct pts pts[sumstep];

cnclt mycnclt(100);

const int endPin[sumstep] = {43, 44, 45};
const int ENA[sumstep] = {4, 5, 6};
const int DIR[sumstep] = {7, 8, 9};
const int STEP[sumstep] = {10, 11, 12};

int endPinCount;

char ch = "a";

int i;
int count;

void setup() {
  Serial.begin (19200);
  for (i = 0; i < 3; i++) {
    pinMode(endPin[i], INPUT);
    pts[i].pinStatus = 0;
  }
}


void loop() {
  count = mycnclt.endSwitchStatus(100, endPin[1]);
  Serial.println (count);
  if (Serial.available()) {
    ch = Serial.read();
    if (ch >= 1) {
      Serial.print ("enter");
      Serial.println (ch);
    }
  }
}

int SwitchCount() {
  for (i = 0; i < sumstep; i++) {
    endPinCount = digitalRead(endPin[i]);
    return endPinCount;
  }
}
